<?xml version="1.0"?>
<launch>
    <!-- LAUNCH INTERFACE -->
    <arg name="hardware_interface" default="PositionJointInterface"/>
    <arg name="port" default="30200"/>

    <!-- need to load joint names  -->
    <rosparam command="load" file="$(find dual_iiwa_controller)/config/joint_names.yaml" />
    
    <rosparam file="$(find dual_iiwa_controller)/config/iiwa_fri_control.yaml" command="load" />
    
    <arg name="controllers" default="joint_state_controller $(arg hardware_interface)_trajectory_controller"/>

    <include file="$(find iiwa_fri_description)/launch/dual_iiwa_upload.launch">
        <arg name="hardware_interface" value="$(arg hardware_interface)"/>
    </include>

    <group ns="iiwa7">
        
        <!-- Load the controllers -->
        <node name="controller_spawner" pkg="controller_manager" type="spawner" respawn="false"
              output="screen" args="$(arg controllers) --shutdown-timeout 2" />
              
        <!-- Converts joint states to TF transforms for rviz, etc -->
        <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher"
              respawn="false" output="screen">
            <remap from="joint_states" to="/joint_states" />
        </node>

        <!-- Hardware interface to be loaded /-->
        <param name="interface" value="$(arg hardware_interface)"/>
        <param name="hostname" type="string" value="192.170.10.2"/>
        <param name="port" value="30200"/>

        <!-- the real hardware interface /-->
        <node name="iiwa_fri_hardware" pkg="iiwa_fri_ros" type="iiwa_controller" respawn="false"/>
    </group>
    
    <group ns="iiwa14">
        
        <!-- Load the controllers -->
        <node name="controller_spawner" pkg="controller_manager" type="spawner" respawn="false"
              output="screen" args="$(arg controllers) --shutdown-timeout 2" />
              
        <!-- Converts joint states to TF transforms for rviz, etc -->
        <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher"
              respawn="false" output="screen">
            <remap from="joint_states" to="/joint_states" />
        </node>

        <!-- Hardware interface to be loaded /-->
        <param name="interface" value="$(arg hardware_interface)"/>
        <param name="hostname" type="string" value="192.170.11.3"/>
        <param name="port" value="30201"/>

        <!-- the real hardware interface /-->
        <node name="iiwa_fri_hardware" pkg="iiwa_fri_ros" type="iiwa_controller" respawn="false"/>
    </group>
</launch>
